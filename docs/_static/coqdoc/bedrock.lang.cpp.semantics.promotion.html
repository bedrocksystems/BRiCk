<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
-- Copyright (c) 2020 BedRock Systems, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="../css/coqdocjs/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="../css/coqdocjs/coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../js/coqdocjs/config.js"></script>
<script type="text/javascript" src="../js/coqdocjs/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <!-- NOTE: These are displayed right to left on the page -->
    <span class="right">
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> `theories/` </a>
      <a href="../../index.html"> Toplevel </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">bedrock.lang.cpp.semantics.promotion</h1>

<div class="code">
<span class="comment">(*<br/>
&nbsp;*&nbsp;Copyright&nbsp;(c)&nbsp;2020-22&nbsp;BedRock&nbsp;Systems,&nbsp;Inc.<br/>
&nbsp;*&nbsp;This&nbsp;software&nbsp;is&nbsp;distributed&nbsp;under&nbsp;the&nbsp;terms&nbsp;of&nbsp;the&nbsp;BedRock&nbsp;Open-Source&nbsp;License.<br/>
&nbsp;*&nbsp;See&nbsp;the&nbsp;LICENSE-BedRock&nbsp;file&nbsp;in&nbsp;the&nbsp;repository&nbsp;root&nbsp;for&nbsp;details.<br/>
&nbsp;*)</span><br/>
</div>

<div class="doc">
<a id="lab152"></a><h1 class="section">Type-level semantics of type promotions</h1>


<div class="paragraph"> </div>

    This captures the rules that C++ uses to promote values to integral types for
    the purposes of performing computation.

<div class="paragraph"> </div>

    This file contains *only* static-semantics, i.e. determining what casts should
    be performed. The dynamic semantics of casts is defined in <span class="inlinecode"><span class="id" title="library">semantics</span>/<span class="id" title="var">cast.v</span></span>
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">bedrock.prelude</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bedrock.prelude.base.html#"><span class="id" title="library">base</span></a> <a class="idref" href="bedrock.prelude.numbers.html#"><span class="id" title="library">numbers</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">bedrock.lang.cpp.arith</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="bedrock.lang.cpp.arith.operator.html#"><span class="id" title="library">operator</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">bedrock.lang.cpp</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="bedrock.lang.cpp.ast.html#"><span class="id" title="library">ast</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.values.html#"><span class="id" title="library">semantics.values</span></a>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#underlying_type"><span class="id" title="definition">underlying_type</span></a></span> <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.logic.func.html#with_cpp.tu"><span class="id" title="variable">tu</span></a></span> <span class="inlinecode"><span class="id" title="var">nm</span></span> is the type that underlies <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tenum"><span class="id" title="constructor">Tenum</span></a></span> <span class="inlinecode"><span class="id" title="var">nm</span></span>.
 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="underlying_type" class="idref" href="#underlying_type"><span class="id" title="definition">underlying_type</span></a> (<a id="tu:1" class="idref" href="#tu:1"><span class="id" title="binder">tu</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#translation_unit"><span class="id" title="record">translation_unit</span></a>) (<a id="nm:2" class="idref" href="#nm:2"><span class="id" title="binder">nm</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.names.html#globname"><span class="id" title="definition">globname</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#tu:1"><span class="id" title="variable">tu</span></a>.(<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#globals"><span class="id" title="projection">globals</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#4fa0a1d38759705f0ddcbbfc0f886b59"><span class="id" title="notation">!!</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#nm:2"><span class="id" title="variable">nm</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#Genum"><span class="id" title="constructor">Genum</span></a> <span class="id" title="var">ty</span> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.typing.html#drop_qualifiers"><span class="id" title="definition">drop_qualifiers</span></a> <span class="id" title="var">ty</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#representation_type"><span class="id" title="definition">representation_type</span></a></span> <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.logic.func.html#with_cpp.tu"><span class="id" title="variable">tu</span></a></span> <span class="inlinecode"><span class="id" title="var">ty</span></span> is the type that underlies <span class="inlinecode"><span class="id" title="var">ty</span></span> if <span class="inlinecode"><span class="id" title="var">ty</span></span> is an <span class="inlinecode"><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.finite.html#enum"><span class="id" title="method">enum</span></a></span>,
    otherwise, it is the orginal type.

<div class="paragraph"> </div>

    Note that if the <span class="inlinecode"><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.finite.html#enum"><span class="id" title="method">enum</span></a></span> is not defined in the translation unit, then the result
    it the original <span class="inlinecode"><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.finite.html#enum"><span class="id" title="method">enum</span></a></span>.
 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="representation_type" class="idref" href="#representation_type"><span class="id" title="definition">representation_type</span></a> (<a id="tu:3" class="idref" href="#tu:3"><span class="id" title="binder">tu</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#translation_unit"><span class="id" title="record">translation_unit</span></a>) (<a id="ty:4" class="idref" href="#ty:4"><span class="id" title="binder">ty</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a>) : <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.syntax.typing.html#drop_qualifiers"><span class="id" title="definition">drop_qualifiers</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:4"><span class="id" title="variable">ty</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tenum"><span class="id" title="constructor">Tenum</span></a> <span class="id" title="var">nm</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ty</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.option.html#default"><span class="id" title="abbreviation">default</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:4"><span class="id" title="variable">ty</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#underlying_type"><span class="id" title="definition">underlying_type</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#tu:3"><span class="id" title="variable">tu</span></a> <span class="id" title="var">nm</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">ty</span> =&gt; <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:4"><span class="id" title="variable">ty</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Example</span> <a id="underlying_int" class="idref" href="#underlying_int"><span class="id" title="definition">underlying_int</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a id="tu:5" class="idref" href="#tu:5"><span class="id" title="binder">tu</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#representation_type"><span class="id" title="definition">representation_type</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#tu:5"><span class="id" title="variable">tu</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">compute</span>; <span class="id" title="tactic">auto</span>).<br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Example</span> <a id="underlying_int" class="idref" href="#underlying_int"><span class="id" title="definition">underlying_int</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a id="tu:6" class="idref" href="#tu:6"><span class="id" title="binder">tu</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#representation_type"><span class="id" title="definition">representation_type</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#tu:6"><span class="id" title="variable">tu</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.types.html#Qconst"><span class="id" title="definition">Qconst</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">compute</span>; <span class="id" title="tactic">auto</span>).<br/>

<br/>
<span class="comment">(*<br/>
<span class="comment">(**&nbsp;<span class="inlinecode"><span class="id" title="var">underlying_unqual_type</span></span> <span class="inlinecode"><span class="id" title="var">tu</span></span> <span class="inlinecode"><span class="id" title="var">ty</span></span>&nbsp;is&nbsp;the&nbsp;unqualified&nbsp;type&nbsp;that&nbsp;underlies&nbsp;<span class="inlinecode"><span class="id" title="var">ty</span></span>.<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;the&nbsp;strip&nbsp;qualifiers&nbsp;function&nbsp;if&nbsp;<span class="inlinecode"><span class="id" title="var">ty</span></span>&nbsp;is&nbsp;not&nbsp;an&nbsp;`enum`.<br/>
<br/>
&nbsp;*)</span><br/>
Definition&nbsp;underlying_unqual_type&nbsp;(tu&nbsp;:&nbsp;translation_unit)&nbsp;(ty&nbsp;:&nbsp;type)&nbsp;:&nbsp;type&nbsp;:=<br/>
&nbsp;&nbsp;let&nbsp;'(cv,&nbsp;ty')&nbsp;:=&nbsp;decompose_type&nbsp;ty&nbsp;in<br/>
&nbsp;&nbsp;match&nbsp;ty'&nbsp;with<br/>
&nbsp;&nbsp;|&nbsp;Tenum&nbsp;nm&nbsp;as&nbsp;ty&nbsp;=&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match&nbsp;tu.(globals)&nbsp;!!&nbsp;nm&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Some&nbsp;(Genum&nbsp;ty&nbsp;_)&nbsp;=&gt;&nbsp;ty<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;ty'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br/>
&nbsp;&nbsp;|&nbsp;_&nbsp;=&gt;&nbsp;ty'<br/>
&nbsp;&nbsp;end.<br/>
<br/>
Succeed&nbsp;Example&nbsp;underlying_int&nbsp;:&nbsp;forall&nbsp;tu,&nbsp;underlying_unqual_type&nbsp;tu&nbsp;(Qconst&nbsp;Tint)&nbsp;=&nbsp;Tint&nbsp;:=<br/>
&nbsp;&nbsp;ltac:(compute;&nbsp;auto).<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="representable" class="idref" href="#representable"><span class="id" title="section">representable</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<a id="8fe0309a395dd0f70ca736ba68316e70" class="idref" href="#8fe0309a395dd0f70ca736ba68316e70"><span class="id" title="binder">σ</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv"><span class="id" title="class">genv</span></a>}.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="var">fully_representable</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span>&nbsp;is&nbsp;<span class="inlinecode"><span class="id" title="var">true</span></span>&nbsp;if&nbsp;all&nbsp;(well-typed)&nbsp;values&nbsp;of&nbsp;<span class="inlinecode"><span class="id" title="var">a</span></span>&nbsp;values&nbsp;of&nbsp;<span class="inlinecode"><span class="id" title="var">b</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="fully_representable" class="idref" href="#fully_representable"><span class="id" title="definition">fully_representable</span></a> (<a id="a:8" class="idref" href="#a:8"><span class="id" title="binder">a</span></a> <a id="b:9" class="idref" href="#b:9"><span class="id" title="binder">b</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="to_equiv:12" class="idref" href="#to_equiv:12"><span class="id" title="binder">to_equiv</span></a> <a id="ty:10" class="idref" href="#ty:10"><span class="id" title="binder">ty</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:10"><span class="id" title="variable">ty</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnum"><span class="id" title="constructor">Tnum</span></a> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.genv.html#integral_type.mk"><span class="id" title="constructor">integral_type.mk</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#a:8"><span class="id" title="variable">a</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#b:9"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tchar_"><span class="id" title="constructor">Tchar_</span></a> <span class="id" title="var">ct</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.genv.html#equivalent_int_type"><span class="id" title="definition">equivalent_int_type</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="min:17" class="idref" href="#min:17"><span class="id" title="binder">min</span></a> <a id="ty:13" class="idref" href="#ty:13"><span class="id" title="binder">ty</span></a> := <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> '(<a id="pat:16" class="idref" href="#pat:16"><span class="id" title="binder">integral_type.mk</span></a> <a id="pat:16" class="idref" href="#pat:16"><span class="id" title="binder">sz</span></a> <a id="pat:16" class="idref" href="#pat:16"><span class="id" title="binder">sgn</span></a>) =&gt; <a class="idref" href="bedrock.lang.cpp.arith.types.html#min_val"><span class="id" title="definition">min_val</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#sz:15"><span class="id" title="variable">sz</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#sgn:14"><span class="id" title="variable">sgn</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">&lt;$&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#to_equiv:12"><span class="id" title="variable">to_equiv</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:13"><span class="id" title="variable">ty</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="max:22" class="idref" href="#max:22"><span class="id" title="binder">max</span></a> <a id="ty:18" class="idref" href="#ty:18"><span class="id" title="binder">ty</span></a> := <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> '(<a id="pat:21" class="idref" href="#pat:21"><span class="id" title="binder">integral_type.mk</span></a> <a id="pat:21" class="idref" href="#pat:21"><span class="id" title="binder">sz</span></a> <a id="pat:21" class="idref" href="#pat:21"><span class="id" title="binder">sgn</span></a>) =&gt; <a class="idref" href="bedrock.lang.cpp.arith.types.html#max_val"><span class="id" title="definition">max_val</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#sz:20"><span class="id" title="variable">sz</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#sgn:19"><span class="id" title="variable">sgn</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#2eea06883886179dcc86cdc5a1870594"><span class="id" title="notation">&lt;$&gt;</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#to_equiv:12"><span class="id" title="variable">to_equiv</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:18"><span class="id" title="variable">ty</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#min:17"><span class="id" title="variable">min</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#a:8"><span class="id" title="variable">a</span></a> , <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#min:17"><span class="id" title="variable">min</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#b:9"><span class="id" title="variable">b</span></a> , <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#max:22"><span class="id" title="variable">max</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#a:8"><span class="id" title="variable">a</span></a> , <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#max:22"><span class="id" title="variable">max</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#b:9"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">an</span> , <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">bn</span> , <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">ax</span> , <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">bx</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<span class="id" title="var">bn</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="var">an</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="var">ax</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ZArith.BinInt.html#306329b0eca7a2b86c198702f594ad8e"><span class="id" title="notation">&lt;=</span></a> <span class="id" title="var">bx</span>)%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> , <span class="id" title="var">_</span> , <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="var">first_representable</span></span> <span class="inlinecode"><span class="id" title="var">ty</span></span> <span class="inlinecode"><span class="id" title="var">ls</span></span>&nbsp;gets&nbsp;the&nbsp;first&nbsp;type&nbsp;in&nbsp;<span class="inlinecode"><span class="id" title="var">ls</span></span>&nbsp;that&nbsp;is&nbsp;able&nbsp;to<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fully&nbsp;represent&nbsp;<span class="inlinecode"><span class="id" title="var">ty</span></span><br/>
&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a id="first_representable" class="idref" href="#first_representable"><span class="id" title="definition">first_representable</span></a> (<a id="ty:23" class="idref" href="#ty:23"><span class="id" title="binder">ty</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a>) (<a id="ls:24" class="idref" href="#ls:24"><span class="id" title="binder">ls</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ls:24"><span class="id" title="variable">ls</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">ls</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#fully_representable"><span class="id" title="definition">fully_representable</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:23"><span class="id" title="variable">ty</span></a> <span class="id" title="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#first_representable:25"><span class="id" title="definition">first_representable</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:23"><span class="id" title="variable">ty</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ls:24"><span class="id" title="variable">ls</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#representable"><span class="id" title="section">representable</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab153"></a><h2 class="section">Integral Promotion</h2>

    This is used to promote a type to a type that supports arithmetic operators.
    For example, it converts types smaller than `int` to `int` (of some signedness).
    Because it converts `enum` types to integral types, it takes a <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#translation_unit"><span class="id" title="record">translation_unit</span></a></span>.

<div class="paragraph"> </div>

    The operation is partial for non-integral types, e.g. struct types.

<div class="paragraph"> </div>

    Note that integral promotion does *not* change the value in the C++ semantics;
    however, it does change from <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.semantics.values.html#VAL_MIXIN.Vchar"><span class="id" title="constructor">Vchar</span></a></span> to an equivalent <span class="inlinecode"><a class="idref" href="bedrock.lang.cpp.semantics.values.html#VAL_MIXIN.Vint"><span class="id" title="constructor">Vint</span></a></span> in BRiCk's
    architecture-independent semantics.

<div class="paragraph"> </div>

    &gt; A prvalue of an integer type other than `bool`, `char8_t`, `char16_t`,
    &gt; `char32_t`, or `wchar_t` whose integer conversion rank (<span class="inlinecode"><span class="id" title="var">conv.rank</span></span>)
    &gt; is less than the rank of `int` can be converted to a prvalue of type `int`
    &gt; if int can represent all the values of the source type; otherwise, the
    &gt; source prvalue can be converted to a prvalue of type `unsigned int`.

<div class="paragraph"> </div>

    &lt;https://eel.is/c++draft/conv.prom&gt;

<div class="paragraph"> </div>

 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="promote_integral" class="idref" href="#promote_integral"><span class="id" title="definition">promote_integral</span></a> {<a id="51578e5097ca1e0a116e50ad4dce93c4" class="idref" href="#51578e5097ca1e0a116e50ad4dce93c4"><span class="id" title="binder">σ</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv"><span class="id" title="class">genv</span></a>} (<a id="tu:28" class="idref" href="#tu:28"><span class="id" title="binder">tu</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.translation_unit.html#translation_unit"><span class="id" title="record">translation_unit</span></a>) (<a id="ty:29" class="idref" href="#ty:29"><span class="id" title="binder">ty</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#representation_type"><span class="id" title="definition">representation_type</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#tu:28"><span class="id" title="variable">tu</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:29"><span class="id" title="variable">ty</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;signed&nbsp;char&nbsp;or&nbsp;short&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;int&nbsp;*)</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tschar"><span class="id" title="abbreviation">Tschar</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tshort"><span class="id" title="abbreviation">Tshort</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;unsigned&nbsp;char&nbsp;or&nbsp;unsigned&nbsp;short&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;int&nbsp;if&nbsp;it&nbsp;can&nbsp;hold&nbsp;its&nbsp;entire<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;range,&nbsp;and&nbsp;unsigned&nbsp;int&nbsp;otherwise&nbsp;*)</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tuchar"><span class="id" title="abbreviation">Tuchar</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">ty</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tushort"><span class="id" title="abbreviation">Tushort</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">ty</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#fully_representable"><span class="id" title="definition">fully_representable</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:29"><span class="id" title="variable">ty</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tuint"><span class="id" title="abbreviation">Tuint</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnum"><span class="id" title="constructor">Tnum</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ty</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:29"><span class="id" title="variable">ty</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tchar"><span class="id" title="abbreviation">Tchar</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <span class="id" title="keyword">let</span> <a id="rty:30" class="idref" href="#rty:30"><span class="id" title="binder">rty</span></a> := <span class="id" title="keyword">if</span> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#51578e5097ca1e0a116e50ad4dce93c4"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#char_signed"><span class="id" title="projection">char_signed</span></a>) <span class="id" title="keyword">is</span> <a class="idref" href="bedrock.lang.cpp.arith.types.html#Signed"><span class="id" title="constructor">Signed</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tschar"><span class="id" title="abbreviation">Tschar</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tuchar"><span class="id" title="abbreviation">Tuchar</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#fully_representable"><span class="id" title="definition">fully_representable</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#rty:30"><span class="id" title="variable">rty</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tuint"><span class="id" title="abbreviation">Tuint</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Twchar"><span class="id" title="abbreviation">Twchar</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tchar_"><span class="id" title="constructor">Tchar_</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#char_type.C8"><span class="id" title="constructor">char_type.C8</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tchar_"><span class="id" title="constructor">Tchar_</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#char_type.C16"><span class="id" title="constructor">char_type.C16</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tchar_"><span class="id" title="constructor">Tchar_</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#char_type.C32"><span class="id" title="constructor">char_type.C32</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;wchar_t,&nbsp;char8_t&nbsp;(since&nbsp;C++20),&nbsp;char16_t,&nbsp;and&nbsp;char32_t<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(since&nbsp;C++11)&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;the&nbsp;first&nbsp;type&nbsp;from&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;following&nbsp;list&nbsp;able&nbsp;to&nbsp;hold&nbsp;their&nbsp;entire&nbsp;value&nbsp;range:&nbsp;int,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int,&nbsp;long,&nbsp;unsigned&nbsp;long,&nbsp;long&nbsp;long,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;long&nbsp;long&nbsp;(since&nbsp;C++11)&nbsp;*)</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#first_representable"><span class="id" title="definition">first_representable</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty:29"><span class="id" title="variable">ty</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tuint"><span class="id" title="abbreviation">Tuint</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tlong"><span class="id" title="abbreviation">Tlong</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tulong"><span class="id" title="abbreviation">Tulong</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tlonglong"><span class="id" title="abbreviation">Tlonglong</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tulonglong"><span class="id" title="abbreviation">Tulonglong</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tenum"><span class="id" title="constructor">Tenum</span></a> <span class="id" title="var">nm</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;unreachable&nbsp;because&nbsp;of&nbsp;<span class="inlinecode"><span class="id" title="var">underlying_type</span></span>&nbsp;and&nbsp;because&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;underlying&nbsp;type&nbsp;of&nbsp;an&nbsp;`enum`&nbsp;must&nbsp;be&nbsp;a&nbsp;fundamental&nbsp;type.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;an&nbsp;unscoped&nbsp;enumeration&nbsp;type&nbsp;whose&nbsp;underlying&nbsp;type<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;not&nbsp;fixed&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;the&nbsp;first&nbsp;type&nbsp;from&nbsp;the&nbsp;following<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;able&nbsp;to&nbsp;hold&nbsp;their&nbsp;entire&nbsp;value&nbsp;range:&nbsp;int,&nbsp;unsigned&nbsp;int,&nbsp;long,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;long,&nbsp;long&nbsp;long,&nbsp;or&nbsp;unsigned&nbsp;long&nbsp;long,&nbsp;extended&nbsp;integer<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;types&nbsp;with&nbsp;higher&nbsp;conversion&nbsp;rank&nbsp;(in&nbsp;rank&nbsp;order,&nbsp;signed&nbsp;given<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;preference&nbsp;over&nbsp;unsigned)&nbsp;(since&nbsp;C++11).&nbsp;If&nbsp;the&nbsp;value&nbsp;range&nbsp;is<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;greater,&nbsp;no&nbsp;integral&nbsp;promotions&nbsp;apply;<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;an&nbsp;unscoped&nbsp;enumeration&nbsp;type&nbsp;whose&nbsp;underlying&nbsp;type&nbsp;is<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixed&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;its&nbsp;underlying&nbsp;type,&nbsp;and,&nbsp;if&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;underlying&nbsp;type&nbsp;is&nbsp;also&nbsp;subject&nbsp;to&nbsp;integral&nbsp;promotion,&nbsp;to&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;promoted&nbsp;underlying&nbsp;type.&nbsp;Conversion&nbsp;to&nbsp;the&nbsp;unpromoted&nbsp;underlying<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;is&nbsp;better&nbsp;for&nbsp;the&nbsp;purposes&nbsp;of&nbsp;overload&nbsp;resolution)<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOTE:&nbsp;this&nbsp;only&nbsp;applies&nbsp;to&nbsp;`unscoped`&nbsp;enumerations;&nbsp;however,&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program&nbsp;will&nbsp;never&nbsp;contain&nbsp;these&nbsp;sorts&nbsp;of&nbsp;implicit&nbsp;conversions&nbsp;for<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scoped&nbsp;enumerations,&nbsp;so&nbsp;we&nbsp;do&nbsp;not&nbsp;need&nbsp;to&nbsp;check&nbsp;this&nbsp;fact.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tbool"><span class="id" title="constructor">Tbool</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tptr"><span class="id" title="constructor">Tptr</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tref"><span class="id" title="constructor">Tref</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Trv_ref"><span class="id" title="constructor">Trv_ref</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tvoid"><span class="id" title="constructor">Tvoid</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tarray"><span class="id" title="constructor">Tarray</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnamed"><span class="id" title="constructor">Tnamed</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tfunction"><span class="id" title="constructor">Tfunction</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tmember_pointer"><span class="id" title="constructor">Tmember_pointer</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tfloat"><span class="id" title="constructor">Tfloat</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnullptr"><span class="id" title="constructor">Tnullptr</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tarch"><span class="id" title="constructor">Tarch</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tqualified"><span class="id" title="constructor">Tqualified</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="comment">(*&nbsp;unreachable&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">forall</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">{</span></a><a id="5df2e7e27fd0e7c499ff2f308d8e465d" class="idref" href="#5df2e7e27fd0e7c499ff2f308d8e465d"><span class="id" title="binder">σ</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">genv</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">}</span></a> <a id="tu:32" class="idref" href="#tu:32"><span class="id" title="binder">tu</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">,</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">promote_integral</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">tu</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">Tchar</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">=</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">Some</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">Tint</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#promote_integral"><span class="id" title="definition">promote_integral</span></a>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#char_signed"><span class="id" title="projection">char_signed</span></a> σ); <span class="id" title="var">done</span>.<br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Qed</span>. <span class="id" title="keyword">Abort</span>.<br/>
<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">forall</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">{</span></a><a id="4c6c5f9d294d87c4d7c3175f2cf027c5" class="idref" href="#4c6c5f9d294d87c4d7c3175f2cf027c5"><span class="id" title="binder">σ</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">:</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">genv</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">}</span></a> <a id="tu:34" class="idref" href="#tu:34"><span class="id" title="binder">tu</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">,</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">promote_integral</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">tu</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">Twchar</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">=</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">Some</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">(</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">integral_type.to_type</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">$</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">equivalent_int_type</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">_</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">char_type.Cwchar</span></a><a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#promote_integral"><span class="id" title="definition">promote_integral</span></a>/<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#equivalent_int_type"><span class="id" title="definition">equivalent_int_type</span></a>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#fully_representable"><span class="id" title="definition">fully_representable</span></a>/=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="bedrock.lang.cpp.semantics.genv.html#wchar_signed"><span class="id" title="projection">wchar_signed</span></a> σ); <span class="id" title="var">done</span>.<br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Qed</span>. <span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Test&nbsp;cases&nbsp;*)</span><br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Example</span> <a id="promote_short" class="idref" href="#promote_short"><span class="id" title="definition">promote_short</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">{</span></a><a id="8b3949d2de8620e054410c326ed1c9c8" class="idref" href="#8b3949d2de8620e054410c326ed1c9c8"><span class="id" title="binder">σ</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv"><span class="id" title="class">genv</span></a>} <a id="tu:36" class="idref" href="#tu:36"><span class="id" title="binder">tu</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#promote_integral"><span class="id" title="definition">promote_integral</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#tu:36"><span class="id" title="variable">tu</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tshort"><span class="id" title="abbreviation">Tshort</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">compute</span>; <span class="id" title="tactic">reflexivity</span>).<br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Example</span> <a id="promote_uchar" class="idref" href="#promote_uchar"><span class="id" title="definition">promote_uchar</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">{</span></a><a id="94078804e95e06d93abd3f704373ee2e" class="idref" href="#94078804e95e06d93abd3f704373ee2e"><span class="id" title="binder">σ</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv"><span class="id" title="class">genv</span></a>} <a id="tu:38" class="idref" href="#tu:38"><span class="id" title="binder">tu</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#promote_integral"><span class="id" title="definition">promote_integral</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#tu:38"><span class="id" title="variable">tu</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tuchar"><span class="id" title="abbreviation">Tuchar</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">compute</span>; <span class="id" title="tactic">reflexivity</span>).<br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Example</span> <a id="promote_schar" class="idref" href="#promote_schar"><span class="id" title="definition">promote_schar</span></a> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">forall</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">{</span></a><a id="280fe6e9a98af7df6c57e9f4080a26e0" class="idref" href="#280fe6e9a98af7df6c57e9f4080a26e0"><span class="id" title="binder">σ</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.genv.html#genv"><span class="id" title="class">genv</span></a>} <a id="tu:40" class="idref" href="#tu:40"><span class="id" title="binder">tu</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#a46514f7419edb3d22453078cf7c9fb7"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#promote_integral"><span class="id" title="definition">promote_integral</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#tu:40"><span class="id" title="variable">tu</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tschar"><span class="id" title="abbreviation">Tschar</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">compute</span>; <span class="id" title="tactic">reflexivity</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab154"></a><h2 class="section">Arithmetic Promotion</h2>

  This computes a "join" on the types of the two arguments to an arithmetic
  operator.

<div class="paragraph"> </div>

  https://eel.is/c++draft/expr.arith.conv1.3

  (1.3.1) If both operands have the same type, no further conversion is needed.
  (1.3.2) Otherwise, if both operands have signed integer types or both have
          unsigned integer types, the operand with the type of lesser integer
          conversion rank is converted to the type of the operand with greater
          rank.
  (1.3.3) Otherwise, if the operand that has unsigned integer type has rank
          greater than or equal to the rank of the type of the other operand,
          the operand with signed integer type is converted to the type of the
          operand with unsigned integer type.
  (1.3.4) Otherwise, if the type of the operand with signed integer type can
          represent all of the values of the type of the operand with unsigned
          integer type, the operand with unsigned integer type is converted to
          the type of the operand with signed integer type.
  (1.3.5) Otherwise, both operands are converted to the unsigned integer type
          corresponding to the type of the operand with signed integer type.
  
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="promote_arith" class="idref" href="#promote_arith"><span class="id" title="definition">promote_arith</span></a> (<a id="ty1:41" class="idref" href="#ty1:41"><span class="id" title="binder">ty1</span></a> <a id="ty2:42" class="idref" href="#ty2:42"><span class="id" title="binder">ty2</span></a> : <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#type"><span class="id" title="inductive">type</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty1:41"><span class="id" title="variable">ty1</span></a> , <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ty2:42"><span class="id" title="variable">ty2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnum"><span class="id" title="constructor">Tnum</span></a> <span class="id" title="var">sz1</span> <span class="id" title="var">sgn1</span> , <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnum"><span class="id" title="constructor">Tnum</span></a> <span class="id" title="var">sz2</span> <span class="id" title="var">sgn2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<span class="id" title="var">sgn1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">sgn2</span>) <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnum"><span class="id" title="constructor">Tnum</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.types.html#int_type.t_max"><span class="id" title="definition">int_type.t_max</span></a> <span class="id" title="var">sz1</span> <span class="id" title="var">sz2</span>) <span class="id" title="var">sgn1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="ssz:46" class="idref" href="#ssz:46"><span class="id" title="binder">ssz</span></a>, <a id="usz:47" class="idref" href="#usz:47"><span class="id" title="binder">usz</span></a>) := <span class="id" title="keyword">match</span> <span class="id" title="var">sgn1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.arith.types.html#Signed"><span class="id" title="constructor">Signed</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">sz1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">sz2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="bedrock.lang.cpp.arith.types.html#Unsigned"><span class="id" title="constructor">Unsigned</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">sz2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">sz1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.types.html#int_type.t_le"><span class="id" title="definition">int_type.t_le</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ssz:46"><span class="id" title="variable">ssz</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#usz:47"><span class="id" title="variable">usz</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnum"><span class="id" title="constructor">Tnum</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#usz:47"><span class="id" title="variable">usz</span></a> <a class="idref" href="bedrock.lang.cpp.arith.types.html#Unsigned"><span class="id" title="constructor">Unsigned</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.decidable.html#bool_decide"><span class="id" title="definition">bool_decide</span></a> (<a class="idref" href="bedrock.lang.cpp.syntax.types.html#int_type.t_le"><span class="id" title="definition">int_type.t_le</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#usz:47"><span class="id" title="variable">usz</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ssz:46"><span class="id" title="variable">ssz</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnum"><span class="id" title="constructor">Tnum</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ssz:46"><span class="id" title="variable">ssz</span></a> <a class="idref" href="bedrock.lang.cpp.arith.types.html#Signed"><span class="id" title="constructor">Signed</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tnum"><span class="id" title="constructor">Tnum</span></a> <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#ssz:46"><span class="id" title="variable">ssz</span></a> <a class="idref" href="bedrock.lang.cpp.arith.types.html#Unsigned"><span class="id" title="constructor">Unsigned</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> , <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Test&nbsp;cases&nbsp;*)</span><br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Example</span> <a id="promote_int_long" class="idref" href="#promote_int_long"><span class="id" title="definition">promote_int_long</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#promote_arith"><span class="id" title="definition">promote_arith</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tlong"><span class="id" title="abbreviation">Tlong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tlong"><span class="id" title="abbreviation">Tlong</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>.<br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Example</span> <a id="promote_int_ulong" class="idref" href="#promote_int_ulong"><span class="id" title="definition">promote_int_ulong</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#promote_arith"><span class="id" title="definition">promote_arith</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tint"><span class="id" title="abbreviation">Tint</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tulong"><span class="id" title="abbreviation">Tulong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tulong"><span class="id" title="abbreviation">Tulong</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>.<br/>
<span class="id" title="var">Succeed</span> <span class="id" title="keyword">Example</span> <a id="promote_uint_long" class="idref" href="#promote_uint_long"><span class="id" title="definition">promote_uint_long</span></a> : <a class="idref" href="bedrock.lang.cpp.semantics.promotion.html#promote_arith"><span class="id" title="definition">promote_arith</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tuint"><span class="id" title="abbreviation">Tuint</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tlong"><span class="id" title="abbreviation">Tlong</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="bedrock.lang.cpp.syntax.types.html#Tlong"><span class="id" title="abbreviation">Tlong</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.17.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>.<br/>
</div>
<!--
-- Copyright (c) 2020 BedRock Systems, Inc.
-- This software is distributed under the terms of the BedRock Open-Source License.
-- See the LICENSE-BedRock file in the repository root for details.
-->

<!--
-- SPDX-LIcense-Identifier:BSD-2-Clause
-->
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
